// Smooth scroll optimizado
document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener('click',function(e){e.preventDefault();const t=document.querySelector(this.getAttribute('href'));t&&t.scrollIntoView({behavior:'smooth',block:'start'})})});

// Intersection Observer para animaciones con lazy loading
const obs=new IntersectionObserver((entries)=>{entries.forEach(e=>{if(e.isIntersecting){e.target.classList.add('visible');obs.unobserve(e.target)}})},{threshold:0.1,rootMargin:'0px 0px -50px 0px'});

document.querySelectorAll('.fade-in').forEach(el=>obs.observe(el));

// Lazy loading de imágenes
const imgObs=new IntersectionObserver((entries)=>{entries.forEach(e=>{if(e.isIntersecting){const img=e.target;if(img.dataset.src){img.src=img.dataset.src;img.removeAttribute('data-src')}imgObs.unobserve(img)}})},{rootMargin:'50px'});

document.querySelectorAll('img[loading="lazy"]').forEach(img=>imgObs.observe(img));

// Hover effects optimizados para CTAs
document.querySelectorAll('.cta-button').forEach(btn=>{btn.addEventListener('mouseenter',function(){this.style.transform=this.classList.contains('cta-final')?'translateY(-5px) scale(1.05)':'translateY(-3px) scale(1.05)'},!1);btn.addEventListener('mouseleave',function(){this.style.transform='translateY(0) scale(1)'},!1)});

// Tracking de clics en CTAs (para analytics)
document.querySelectorAll('.cta-button').forEach(btn=>{btn.addEventListener('click',function(){const action=this.textContent.trim();console.log('CTA Click:',action);// Aquí integrarías Google Analytics o similar
// gtag('event', 'cta_click', { 'button_text': action });
})});

// Performance: Defer non-critical operations
if('requestIdleCallback' in window){requestIdleCallback(()=>{// Precarga de recursos críticos
const criticalLinks=['img/macbook-air-m4-front.webp','img/macbook-air-m4-side.webp'];criticalLinks.forEach(url=>{const link=document.createElement('link');link.rel='prefetch';link.href=url;document.head.appendChild(link)})})}else{setTimeout(()=>{// Fallback para navegadores antiguos
},1000)}